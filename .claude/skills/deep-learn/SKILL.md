---
name: deep-learn
description: >-
  トピック深掘り学習。「○○を勉強したい」「○○について学びたい」「○○を教えて、しっかり」等で起動。
  quick-explain（30秒解説）と study（フルセッション演習）の間を埋める、
  10〜15分で「教える → 理解チェック → 定着」を一気に行うスキル。
---

# トピック深掘り学習（deep-learn）

特定のトピックについて、10〜15分で「理解 → 確認 → 定着」を完結させる中規模学習スキル。
quick-explain では物足りないが、study のフルセッションを始めるほどではないときに使う。

---

## トリガー

以下のような発言で起動する:
- 「○○を勉強したい」「○○について学びたい」
- 「○○を教えて、しっかり」「○○をちゃんと理解したい」
- 「○○を深く知りたい」「○○を復習したい」

---

## 説明の4ルール（常に適用）

1. **レベルを極限まで落とす**: 専門用語を避け、中学生でも理解できる日常的な言葉で説明
2. **数式よりロジック**: 式より先に「なぜそうなるか」をイメージで説明
3. **算数を使わない解法**: 試験で出たときの「裏技・ハック」を提案
4. **3分ルール**: 説明が長くなりそうなら「★マークをつけて先に進む」判断も含む

---

## フロー（4フェーズ）

### Phase 1: トピック把握（1-2分）

1. ユーザーが指定したトピックを受け取る
2. **トピックが広すぎる場合** → 範囲を絞る対話を挟む
   - 例: 「セキュリティ」→ 「暗号化の種類」「認証方式」「攻撃手法」など候補を提示
3. **FE試験範囲外の場合** → 試験に出る関連分野へ誘導する
4. FE試験の分野マッピングで該当分野を判定（下記の分野判定テーブルを使用）
5. `questions/` から関連問題の有無を確認
6. `learning_progress.md` から現在の理解度を取得
7. **「試験に受かるために知るべきこと」を3つ以内に整理して表示**:

```
📚 [トピック名]を深掘りします！
━━━━━━━━━━━━━━━━━━━━━━━━━━
📂 分野: [該当分野]
📊 現在の理解度: [learning_progress.md から]
📝 関連問題: [questions/ に○問あり / なし]

🎯 試験に受かるために知るべきこと:
  1. [ポイント1]
  2. [ポイント2]
  3. [ポイント3]

では1つ目から説明していきますね！
━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Phase 2: 教える（5-8分）

Phase 1 で整理した「知るべきこと」を **1ポイントずつ段階的に** 説明する。

#### 各ポイントの構成

```
━━━━━━━━━━━━━━━━━━━━━━━━━━
📖 ポイント [N]/[全体数]: [タイトル]
━━━━━━━━━━━━━━━━━━━━━━━━━━

🔰 ひとことで言うと:
  [1行で超簡潔に]

🏠 身近な例え:
  [日常生活の例えで説明]

🔗 つながり:
  [他の概念との関係・全体像の中での位置づけ]

📝 試験ではこう出る:
  [試験での問われ方と解き方のコツ]

━━━━━━━━━━━━━━━━━━━━━━━━━━
```

#### 進行ルール
- 各ポイントの説明後に **「ここまで大丈夫ですか？」** と確認する
- ユーザーが理解できていない場合 → 別の例えで再説明
- 3分経っても理解が難しい場合 → **★マークをつけて次に進む**提案をする
- ユーザーが「わかった」「OK」等と反応したら次のポイントへ

---

### Phase 3: 理解チェック（3-5分）

説明が終わったら、理解度を確認するクイズを出題する。

#### 出題ルール
- **3〜5問** の確認クイズ（4択 or ○×）
- **問題ソース**:
  1. `questions/` に該当問題があれば **優先使用**
  2. なければ **AI即興生成**（一時的な確認用、ファイル保存なし）

#### 出題フォーマット

```
🧪 理解チェック！（[N]問）
━━━━━━━━━━━━━━━━━━━━━━━━━━

Q[N]. [問題文]

  ア: [選択肢1]
  イ: [選択肢2]
  ウ: [選択肢3]
  エ: [選択肢4]

━━━━━━━━━━━━━━━━━━━━━━━━━━
```

- 1問ずつ出題し、ユーザーの回答後に正誤と簡潔な解説を表示
- 既存問題を使用した場合 → **問題ファイルのfrontmatterを更新**:
  - `result_history`: 正誤を追記
  - `last_attempt`: 日付を更新
  - `confidence_history`: ユーザーの自信度を追記（聞く）

#### 結果サマリー

```
📊 結果: [正解数]/[全問数]
━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ Q1: [正解/不正解]
✅ Q2: [正解/不正解]
...
━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### Phase 4: 定着支援（1-2分）

理解チェックの結果に基づいて、定着をサポートする。

#### 全問正解の場合

```
🎉 パーフェクト！
━━━━━━━━━━━━━━━━━━━━━━━━━━
しっかり理解できています！

💡 次のステップ:
  ・別のトピックを深掘りする → 「○○を勉強したい」
  ・演習モードで実戦練習する → 「学習開始」（study スキル）
━━━━━━━━━━━━━━━━━━━━━━━━━━
```

#### 不正解があった場合

1. **「ここだけ覚えればOK」リスト表示（3つ以内）**

```
📝 定着ポイント
━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 ここだけ覚えればOK:
  1. [最重要ポイント]
  2. [重要ポイント]
  3. [補足ポイント]

💡 次のステップ:
  ・もう一度復習する → 「○○を勉強したい」
  ・演習モードで実戦練習する → 「学習開始」（study スキル）
━━━━━━━━━━━━━━━━━━━━━━━━━━
```

#### 全問不正解の場合

ユーザーに選択肢を提示する:
- **Phase 2 に戻る** → もう一度説明し直す（別の例えや切り口で）
- **★マークで先に進む** → 「今は捨てて、他の分野を先にやる」戦略

---

## 基本情報技術者試験の分野判定

質問されたトピックがどの分野に属するか自動判定する:

| 分野 | キーワード例 |
|------|-------------|
| 基礎理論 | 2進数、論理演算、確率、BNF、オートマトン |
| コンピュータシステム | CPU、メモリ、OS、割り込み、仮想記憶 |
| データベース | SQL、正規化、ER図、トランザクション |
| ネットワーク | TCP/IP、DNS、DHCP、サブネット、ルーティング |
| セキュリティ | 暗号、認証、ファイアウォール、マルウェア、PKI |
| 開発技術 | ウォーターフォール、アジャイル、テスト、UML |
| マネジメント | PMBOK、ITIL、SLA、WBS、工数見積もり |
| ストラテジ | 経営戦略、マーケティング、財務、法務、DX |
| 科目B アルゴリズム | ソート、探索、再帰、スタック、キュー、木 |
| 科目B 擬似言語 | 変数、配列、ループ、条件分岐、関数 |

---

## ファイル更新の範囲

| 対象 | 更新する？ | 条件 |
|------|-----------|------|
| `questions/` frontmatter | する | 既存問題を理解チェックで使用した場合のみ |
| `learning_progress.md` | **しない** | study / daily-report の責務 |
| git操作 | **しない** | セッション終了時にまとめて実行する運用 |

---

## エッジケース対応

| ケース | 対応 |
|--------|------|
| トピックが広すぎる | Phase 1 で範囲を絞る対話を挟む |
| FE試験範囲外 | 試験に出る関連分野への誘導を提案 |
| 全問正解 | 次のトピック案内 |
| 全問不正解 | Phase 2 に戻るか★マークで先に進むか選択 |
| 関連問題が questions/ にない | AI即興で確認クイズを生成（保存しない） |

---

## 注意事項

- セッション開始手順（memory_logs等の読み込み）は不要（中規模スキル）
- ただし `learning_progress.md` は Phase 1 で参照する
- 1回の対話で完結しない（Phase 2〜3 でユーザーとのやり取りが発生する）
- 説明の4ルール（中学生レベル・数式よりロジック・指折り・3分ルール）を厳守する
