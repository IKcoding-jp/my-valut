# メタ認知記録・エラーパターン分類

## 目次

1. [自信度×正誤マトリクス](#自信度正誤マトリクス)
2. [メタ認知記録の実行手順](#メタ認知記録の実行手順)
3. [間違いパターン自動分類](#間違いパターン自動分類)
4. [自動判定フロー](#自動判定フロー)

---

## 自信度×正誤マトリクス

| | 正解 | 不正解 |
|---|---|---|
| **自信高** | 定着済み（+3点） | **危険（+0点、最優先復習）** |
| **自信中** | 確認必要（+2点） | 要学習（+0点） |
| **自信低** | 偶然正解？（+1点） | 想定通り（+0点） |

---

## メタ認知記録の実行手順

各問題の解答・自信度確認後に **必ず** 実行する。

### ステップ1: 問題ファイルの frontmatter 更新

対象ファイル（例: `questions/kamoku_a/テクノロジ系/技術要素/R05_KA_Q01.md`）の以下を更新:

```yaml
status: "学習中" or "習得済"  # レベル3以上かつ正解なら"習得済"
last_attempt: 2026-01-28T14:30:00+09:00
confidence_history: ["高"]        # 配列末尾に追加
result_history: ["不正解"]        # 配列末尾に追加
time_spent_seconds: [45]          # 配列末尾に追加
```

### ステップ2: メタ認知ラベルの判定

自信度と正誤の組み合わせからラベルとスコアを付与:

| 組み合わせ | ラベル | スコア | アクション |
|---|---|---|---|
| 自信高 × 正解 | 定着済み | +3 | なし |
| 自信高 × 不正解 | **危険** | +0 | 危険問題リストに追加 |
| 自信中 × 正解 | 確認必要 | +2 | なし |
| 自信中 × 不正解 | 要学習 | +0 | なし |
| 自信低 × 正解 | 偶然正解 | +1 | なし |
| 自信低 × 不正解 | 想定通り | +0 | なし |

### ステップ3: 危険問題の処理

「自信高 × 不正解」（＝危険）が発生した場合:

1. `learning_progress.md` の「危険問題リスト」に追加:

   | 問題ID | 科目 | 分野 | 日時 | 間違いパターン |
   |--------|------|------|------|----------------|
   | R05_KA_Q01 | A | セキュリティ | 2026-01-28 | 概念混同 |

2. ユーザーに警告を表示:
   > ⚠️ この問題は【危険問題】です（自信があるのに不正解）。
   > 次回のセッションで最優先で復習します。

3. 次回セッション開始時、危険問題を最初に出題する

---

## 間違いパターン自動分類

不正解の場合、以下の7パターンから自動判定する。

### 1. 知識不足

**判定条件**:
- 「知らない」「聞いたことない」「初めて見た」と発言
- OR 解答の根拠を全く説明できない
- OR 問題の status が "未学習"

**対策**: 間違えた問題をマーク（重点復習対象に追加）

### 2. 概念混同

**判定条件**:
- 別の概念の説明をしている（例: 共通鍵を問われて公開鍵の説明）
- OR 類似用語を取り違えている（例: SMTP と SNMP、TCP と UDP）

**対策**:
1. 比較表を提示して説明
2. 混同ペアの問題を重点復習対象に追加
3. `learning_progress.md` の「概念混同リスト」に追加/更新:

   | 混同ペア | 発生回数 | 最終発生日 | 対策カード |
   |----------|----------|------------|------------|
   | 共通鍵暗号 ↔ 公開鍵暗号 | 1 | 2026-01-28 | あり |

### 3. 読み間違い

**判定条件**:
- 解答理由は正しいが、問題文の条件を読み間違えている
- OR 「読み間違えた」とユーザーが申告

**対策**: 記録のみ（追加対応不要）。理解度には影響させない。

### 4. 計算ミス

**判定条件**:
- 解法・手順は正しいが、数値の処理で間違えた
- OR 「計算間違えた」と申告

**対策**:
1. 正しい計算手順を「指折り方式」で再説明
2. 計算手順の問題を重点復習対象に追加

### 5. 説明不足

**判定条件**:
- 正解を選んだが、理由の説明がルーブリックレベル2以下
- 正解だが不正解選択肢の排除理由が言えない（理解系の場合）

**対策**:
1. 精緻化質問で理解を深める
2. 重点復習対象に追加（正解でもレベル2以下なら追加）

### 6. トレースミス（科目B専用）

**判定条件**:
- 擬似言語のコード追跡で変数の値を間違えた
- OR ループ回数や配列インデックスを誤った
- OR for文の範囲を誤読した

**対策**:
1. 正しいトレース表を提示して修正
2. 手順問題を重点復習対象に追加

### 7. 構文誤解（科目B専用）

**判定条件**:
- 擬似言語の構文自体を間違って理解している
  - 例: "÷" を整数除算と理解していない
  - 例: 配列の添字が0始まりか1始まりかを間違えた

**対策**:
1. 正しい構文ルールを説明
2. 構文問題を重点復習対象に追加
3. `learning_progress.md` の擬似言語習熟度を更新

---

## 自動判定フロー

### 不正解の場合

1. ユーザーに「なぜその答えを選びましたか？」と質問（暗記系以外）
2. 回答内容から7パターンのどれに該当するか判定
3. 複数該当する場合は、最も根本的なパターンを選択:

   **優先順**: 知識不足 > 構文誤解 > 概念混同 > トレースミス > 計算ミス > 読み間違い

### 正解だがレベル2以下の場合

→ 「説明不足」と分類

### 記録先

判定結果は問題ファイルの frontmatter には含めず、`learning_progress.md` の該当セクションに記録する。
