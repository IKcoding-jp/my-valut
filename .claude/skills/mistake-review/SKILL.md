---
name: mistake-review
description: >-
  間違いパターン分析＆復習提案。「間違いの傾向は？」「何を間違えやすい？」
  「ミス分析」等で起動。全問題ファイルのresult_historyとconfidence_historyを
  横断分析し、間違い方の種類別に傾向を可視化。具体的な復習プランを提案する。
---

# 間違いパターン分析（mistake-review）

「分野別の弱点」ではなく「間違い方の傾向」にフォーカスした分析スキル。
同じタイプのミスを繰り返していることに気づき、ピンポイントで対策できる。

---

## 実行フロー

### Step 1: データ収集

以下のファイルを読み込む:

1. `learning/基本情報技術者/進捗ログ.md` — 危険問題リスト・概念混同リスト・間違いパターン集計
2. `questions/kamoku_a/` 配下の全問題ファイルの frontmatter（result_history, confidence_history）
3. `questions/kamoku_b/` 配下の全問題ファイルの frontmatter

### Step 2: 間違いパターンの集計

`learning/基本情報技術者/進捗ログ.md` の「間違いパターン集計」テーブルと、
問題ファイルの result_history から以下を集計する:

#### 7つの間違いパターン

| パターン | 説明 | 科目 |
|----------|------|------|
| 知識不足 | そもそも知らなかった | A/B共通 |
| 概念混同 | 似た概念を取り違えた | A/B共通 |
| 読み間違い | 問題文の条件を誤読 | A/B共通 |
| 計算ミス | 手順は正しいが計算を間違えた | 主に科目A |
| 説明不足 | 正解だが理由を説明できない | A/B共通 |
| トレースミス | 変数の値やループ回数を誤った | 科目B専用 |
| 構文誤解 | 擬似言語の構文を誤解 | 科目B専用 |

#### 集計方法

1. 問題ファイルの `result_history` から不正解の回数を数える
2. `learning/基本情報技術者/進捗ログ.md` の間違いパターン集計テーブルを参照
3. 概念混同リストから混同ペアを抽出
4. 危険問題リスト（自信高×不正解）を抽出

### Step 3: 分析レポートの生成

```
🔍 間違いパターン分析
━━━━━━━━━━━━━━━━━━━━━

📊 全体サマリー:
  ・解いた問題: XX問（うち不正解 XX問）
  ・不正解率: XX%
  ・危険問題: X件

📈 間違い方 TOP 3:

1️⃣ [パターン名]（XX%・XX回）
   📍 多い分野: [分野名]
   📝 具体例: [問題ID] — [どう間違えたか]
   💊 対策: [具体的なアクション]

2️⃣ [パターン名]（XX%・XX回）
   📍 多い分野: [分野名]
   📝 具体例: [問題ID]
   💊 対策: [具体的なアクション]

3️⃣ [パターン名]（XX%・XX回）
   📍 多い分野: [分野名]
   📝 具体例: [問題ID]
   💊 対策: [具体的なアクション]

━━━━━━━━━━━━━━━━━━━━━
```

### Step 4: 間違いパターンの自動抽象化

個別の間違いを**抽象的なパターン**に昇華し、根本原因を特定する。

#### 4a. 小分類レベルの繰り返し検出

`questions/` の全問題ファイルを `field`（小分類）でグルーピングし、
同じ小分類で **2回以上不正解** のものを自動検出:

```
🔍 繰り返し間違えている小分類:

| 小分類 | 不正解回数 | 該当問題 | 共通パターン |
|--------|-----------|----------|-------------|
| [小分類名] | X回 | [ID1], [ID2] | [自動判定されたパターン] |

💡 同じ分野で繰り返し間違えている = 根本的な理解が不足している可能性
```

**自動判定ロジック**:
1. 同じ小分類で2問以上不正解 → 「この分野の基礎概念を deep-learn で深掘り推奨」
2. 同じ小分類で confidence が高いのに不正解 → 「概念混同の可能性が高い」
3. 同じ小分類で時間超過が多い → 「解法パターンが定着していない」

#### 4b. 概念混同の自動検出と候補提示

既存の概念混同リスト（`learning/基本情報技術者/進捗ログ.md`）に加え、以下の条件で**新たな混同候補**を自動検出:

- 同じ小分類内で「正解→不正解→正解→不正解」と交互に間違えている問題ペア
- 同じセッション内で、似た分野の問題を「一方は正解、他方は不正解」にした場合
- frontmatter の field が近い2問で、片方のみ正解が繰り返される場合

```
🆕 概念混同の新規候補（自動検出）:

| 混同候補 | 根拠 | 追加する？ |
|----------|------|-----------|
| [概念A] ↔ [概念B] | [ID1]で正解、[ID2]で不正解を交互に繰り返し | → 「はい」で概念混同リストに追加 |
```

ユーザーが「はい」と答えた場合、`learning/基本情報技術者/進捗ログ.md` の概念混同リストへの追加を提案する
（実際の更新は study セッション終了時に行う）。

#### 4c. deep-learn への自動連携提案

繰り返しパターンが検出された場合:

```
📚 深掘り学習の提案:
  「[小分類名]」で X 回間違えています。
  → 「深掘りする」で /deep-learn [トピック名] を開始
  → 「スキップ」で分析レポートの続きへ
```

### Step 5: 概念混同の詳細分析

既存の概念混同リスト + Step 4b で検出された新規候補を統合表示:

```
🔀 概念混同リスト:

【既存】
| 混同ペア | 回数 | 最終発生 | 対策カード |
|----------|------|----------|-----------|
| [概念A] ↔ [概念B] | X回 | MM/DD | [対策] |

【新規候補（自動検出）】
| 混同候補 | 根拠 |
|----------|------|
| [概念C] ↔ [概念D] | [根拠] |

💡 混同が多いペアは比較カードで対策しましょう！
```

### Step 6: 危険問題の一覧（旧Step 5）

危険問題（自信高×不正解）がある場合:

```
⚠️ 危険問題（自信があるのに間違えた問題）:

| 問題ID | 分野 | 間違いパターン | 最終挑戦日 |
|--------|------|----------------|------------|
| [ID] | [分野] | [パターン] | [日付] |

🚨 これらは「わかったつもり」の問題です。
   最優先で復習してください！
```

### Step 7: パターン別の対策提案

間違いパターンごとに具体的な対策を提案:

| パターン | 対策 |
|----------|------|
| 知識不足 | 「かやのき先生の第X章を再読」「間違えた問題を重点復習」 |
| 概念混同 | 「混同ペアの問題を重点復習」「混同ペアの違いを声に出して確認」 |
| 読み間違い | 「問題文の条件に下線を引く習慣をつける」（記録のみ、深追いしない） |
| 計算ミス | 「指折り方式で再練習」「計算手順の問題を重点復習」 |
| 説明不足 | 「なぜその答えか」を頭の中で言語化する練習 |
| トレースミス | 「『出るとこだけ！科目B』のトレース問題を重点的に」 |
| 構文誤解 | 「擬似言語の構文カードを復習」「for文・配列の添字ルールを確認」 |

### Step 8: 今日の復習提案

分析結果を踏まえ、「今すぐやるべき復習」を1つだけ提案:

```
🎯 今日の最優先復習:

  [パターン名] 対策として、[具体的なアクション]

  「学習開始」と入力すれば、この分野の問題から出題します！
```

---

## データが少ない場合の対応

解いた問題数が10問未満の場合:

```
📊 まだデータが少ないため、詳細な分析はできません（現在 XX問）。
   もう少し問題を解いてから再度分析しましょう！

💡 目安: 30問以上解くと、傾向が見えてきます。
   まずは「学習開始」で問題を解いていきましょう！
```

---

## 他スキルとの連携

| スキル | 連携内容 |
|--------|----------|
| deep-learn | Step 4cで繰り返しパターン検出時に深掘り学習を提案・遷移 |
| study | 概念混同リストの更新候補をセッション終了時に反映依頼 |
| recommendation | 間違いパターンTOP3を優先度計算の参考情報として提供 |
| retrospective | 週次レトロスペクティブで間違いパターンの変化を分析 |

---

## 注意事項

- このスキルは基本的にファイルの更新を行わない（読み取り専用）
  - 例外: ユーザーが概念混同リストへの追加を承認した場合のみ、`learning/基本情報技術者/進捗ログ.md` を更新
- セッション開始手順（memory_logs.md読み込み等）は不要
- deep-learn への遷移提案がある場合のみ対話が発生する（それ以外は1回完結）
- 分析結果は簡潔に表示（スクロールせずに読める量）
- 間違いパターンの判定ロジックは `study/references/metacognition.md` に準拠

---

*最終更新: 2026-01-31（自動抽象化・概念混同自動検出・deep-learn連携を追加）*
